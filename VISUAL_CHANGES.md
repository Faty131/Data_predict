# ğŸ“¸ VISUALISATION DES CHANGEMENTS

## Vue Avant/AprÃ¨s

### Frontend - Page de PrÃ©diction

#### AVANT
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ParamÃ¨tres de PrÃ©diction                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Type de Transport    [Bus         â–¼]    â”‚
â”‚ Ligne                [Line1       â–¼]    â”‚
â”‚ Heure de DÃ©part      [08:00       ]    â”‚
â”‚ Jour                 [Lundi       â–¼]    â”‚
â”‚ Conditions MÃ©tÃ©o     [Normal      â–¼]    â”‚
â”‚ Ã‰vÃ©nement Majeur     [Non         â–¼]    â”‚
â”‚                                         â”‚
â”‚        [ğŸš€ Lancer la PrÃ©diction]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### APRÃˆS
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ParamÃ¨tres de PrÃ©diction                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Type de Transport    [Bus         â–¼]    â”‚
â”‚ Ligne                [Line1       â–¼]    â”‚
â”‚ Heure de DÃ©part      [08:00       ]    â”‚
â”‚ Jour                 [Lundi       â–¼]    â”‚
â”‚ Conditions MÃ©tÃ©o     [Normal      â–¼]    â”‚
â”‚ Ã‰vÃ©nement Majeur     [Non         â–¼]    â”‚
â”‚ SÃ©lectionner ModÃ¨le  [Random Forest â–¼] â”‚ â† NOUVEAU!
â”‚    Options:                             â”‚
â”‚    - ğŸŒ² Random Forest (Rapide & PrÃ©cis)â”‚
â”‚    - ğŸ“ˆ RÃ©gression LinÃ©aire (LÃ©ger)    â”‚
â”‚    - ğŸš€ XGBoost (Haute Performance)    â”‚
â”‚                                         â”‚
â”‚        [ğŸš€ Lancer la PrÃ©diction]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### RÃ©sultats de PrÃ©diction

#### AVANT
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      RÃ©sultats de PrÃ©diction     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                  â”‚
â”‚      Retard PrÃ©vu: 12.5 min     â”‚
â”‚                                  â”‚
â”‚  Risque: Moyen | Proba: 65%     â”‚
â”‚                                  â”‚
â”‚  "VÃ©rifiez votre trajet..."     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### APRÃˆS
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      RÃ©sultats de PrÃ©diction     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                  â”‚
â”‚      Retard PrÃ©vu: 12.5 min     â”‚
â”‚                                  â”‚
â”‚  Risque: Moyen | Proba: 65%     â”‚
â”‚                                  â”‚
â”‚   ğŸ§  ModÃ¨le: ğŸš€ XGBoost         â”‚ â† NOUVEAU!
â”‚                                  â”‚
â”‚  "VÃ©rifiez votre trajet..."     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Flux de Communication

### AVANT
```
Frontend                                API
   â”‚                                     â”‚
   â”œâ”€ POST /predict â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
   â”‚  {TransportType, Line, Hour,        â”‚
   â”‚   Day, Weather, Event}              â”‚
   â”‚                                     â”‚
   â”‚<â”€â”€â”€â”€â”€â”€ PrÃ©diction â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
   â”‚  {delay, risk, probability}         â”‚
   â”‚                                     â”‚
   â””â”€ Affiche le rÃ©sultat â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
```

### APRÃˆS
```
Frontend                                API
   â”‚                                     â”‚
   â”œâ”€ POST /predict â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
   â”‚  {TransportType, Line, Hour,        â”‚
   â”‚   Day, Weather, Event,              â”‚
   â”‚   model_type: "xgboost"}    â† NOUVEAU!
   â”‚                                     â”‚
   â”‚  [SÃ©lection du modÃ¨le]              â”‚
   â”‚  â”œâ”€ Charge random_forest.pkl        â”‚
   â”‚  â”œâ”€ Charge linear_regression.pkl    â”‚
   â”‚  â”œâ”€ Charge xgboost.pkl      â† UtilisÃ©!
   â”‚  â””â”€ PrÃ©diction avec XGBoost         â”‚
   â”‚                                     â”‚
   â”‚<â”€â”€â”€â”€â”€â”€ PrÃ©diction â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
   â”‚  {delay, risk, probability,         â”‚
   â”‚   model_used: "xgboost"}     â† NOUVEAU!
   â”‚                                     â”‚
   â””â”€ Affiche rÃ©sultat + modÃ¨le â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
```

## Structure des Fichiers

### Avant
```
models/
â””â”€â”€ random_forest.pkl  (seul modÃ¨le)

train_model.py
â”œâ”€ load_and_prepare_data()
â””â”€ train_and_save_model()
   â””â”€ RandomForestRegressor seul

api.py
â”œâ”€ model = None
â””â”€ /predict
   â””â”€ utilise model unique

frontend/
â””â”€ Prediction.jsx
   â””â”€ sans sÃ©lecteur de modÃ¨le
```

### AprÃ¨s
```
models/
â”œâ”€â”€ random_forest.pkl      (RF)
â”œâ”€â”€ linear_regression.pkl  (LR)
â”œâ”€â”€ xgboost.pkl            (XGB) â† NOUVEAU!
â””â”€â”€ feature_info.pkl

train_model.py
â”œâ”€ load_and_prepare_data()
â””â”€ train_and_save_model()
   â”œâ”€ RandomForestRegressor
   â”œâ”€ LinearRegression
   â””â”€ XGBRegressor â† NOUVEAU!

api.py
â”œâ”€ models = {} â† dict au lieu de model
â”œâ”€ load_models() â† charge les 3
â”œâ”€ /models â† NOUVEAU! liste les modÃ¨les
â””â”€ /predict
   â”œâ”€ reÃ§oit model_type
   â”œâ”€ sÃ©lectionne le modÃ¨le
   â””â”€ inclut model_used dans rÃ©ponse

frontend/
â””â”€ Prediction.jsx
   â”œâ”€ Nouveau champ: model_type
   â”œâ”€ SÃ©lecteur avec 3 options
   â””â”€ Affichage du modÃ¨le utilisÃ©
```

## Endpoints Nouveaux/ModifiÃ©s

### Nouveau
```
GET /models
â”œâ”€ Liste les 3 modÃ¨les disponibles
â”œâ”€ Indique lequel est disponible
â””â”€ Retourne descriptions
```

### ModifiÃ©
```
POST /predict
â”œâ”€ AVANT: {TransportType, Line, Hour, Day, Weather, Event}
â”œâ”€ APRÃˆS: + model_type (optionnel, dÃ©faut: random_forest)
â””â”€ RÃ©ponse: + model_used

GET /health
â”œâ”€ AVANT: {status, model_loaded}
â””â”€ APRÃˆS: {status, models_loaded, available_models[]}
```

## Code Changes Summary

### train_model.py
```python
# AVANT
model = RandomForestRegressor(...)
model.fit(X_train, y_train)
joblib.dump(model, "./models/random_forest.pkl")

# APRÃˆS
models_info = {}
rf_model = RandomForestRegressor(...)
rf_model.fit(X_train, y_train)
joblib.dump(rf_model, "./models/random_forest.pkl")
models_info['random_forest'] = {...}

lr_model = LinearRegression(...)
lr_model.fit(X_train, y_train)
joblib.dump(lr_model, "./models/linear_regression.pkl")
models_info['linear_regression'] = {...}

xgb_model = XGBRegressor(...)
xgb_model.fit(X_train, y_train)
joblib.dump(xgb_model, "./models/xgboost.pkl")
models_info['xgboost'] = {...}
```

### api.py
```python
# AVANT
model = None
def load_model():
    global model
    model = joblib.load("./models/random_forest.pkl")

@app.post("/predict")
async def predict_delay(data: PredictionRequest):
    prediction = model.predict(input_data)[0]

# APRÃˆS
models = {}
def load_models():
    global models
    models['random_forest'] = joblib.load("./models/random_forest.pkl")
    models['linear_regression'] = joblib.load("./models/linear_regression.pkl")
    models['xgboost'] = joblib.load("./models/xgboost.pkl")

class PredictionRequest(BaseModel):
    # ... autres champs
    model_type: str = "random_forest"  # NOUVEAU!

@app.post("/predict")
async def predict_delay(data: PredictionRequest):
    selected_model = models[data.model_type]
    prediction = selected_model.predict(input_data)[0]
    response["model_used"] = data.model_type  # NOUVEAU!
```

### Prediction.jsx
```jsx
// AVANT
const [formData, setFormData] = useState({
    TransportType: '',
    Line: '',
    Hour: '',
    Day: '',
    Weather: '',
    Event: ''
});

const formFields = [
    { name: 'TransportType', ... },
    { name: 'Line', ... },
    { name: 'Hour', ... },
    { name: 'Day', ... },
    { name: 'Weather', ... },
    { name: 'Event', ... }
];

// APRÃˆS
const [formData, setFormData] = useState({
    TransportType: '',
    Line: '',
    Hour: '',
    Day: '',
    Weather: '',
    Event: '',
    model_type: 'random_forest'  // NOUVEAU!
});

const formFields = [
    { name: 'TransportType', ... },
    { name: 'Line', ... },
    { name: 'Hour', ... },
    { name: 'Day', ... },
    { name: 'Weather', ... },
    { name: 'Event', ... },
    {
        name: 'model_type',  // NOUVEAU!
        label: 'SÃ©lectionner le ModÃ¨le IA',
        options: [
            { value: 'random_forest', label: 'ğŸŒ² Random Forest' },
            { value: 'linear_regression', label: 'ğŸ“ˆ RÃ©gression LinÃ©aire' },
            { value: 'xgboost', label: 'ğŸš€ XGBoost' }
        ]
    }
];

// Affichage nouveau
{prediction.model_used && (
    <div className="...">
        <span>ModÃ¨le: {prediction.model_used}</span>
    </div>
)}
```

## Impact sur les Performances

### Taille des ModÃ¨les
```
random_forest.pkl      ~15-20 MB
linear_regression.pkl  ~100-500 KB
xgboost.pkl           ~10-15 MB
```

### Temps de PrÃ©diction (en ms)
```
Random Forest      ~10-50 ms
Linear Regression  ~1-5 ms
XGBoost           ~20-100 ms
```

### Consommation MÃ©moire
```
Au dÃ©marrage:
- Avant: 1 modÃ¨le chargÃ©
- AprÃ¨s: 3 modÃ¨les chargÃ©s (~50 MB supplÃ©mentaires)
```

## CompatibilitÃ©

### Backward Compatibility âœ…
```
Ancienne requÃªte (sans model_type):
POST /predict
{
    "TransportType": "Bus",
    ...
    // Pas de model_type
}

RÃ©sultat: Utilise Random Forest par dÃ©faut âœ…
```

### Forward Compatibility âœ…
```
Nouvelle requÃªte (avec model_type):
POST /predict
{
    "TransportType": "Bus",
    ...
    "model_type": "xgboost"
}

RÃ©sultat: Utilise XGBoost comme demandÃ© âœ…
```

---

**En rÃ©sumÃ©:** Le systÃ¨me supporte maintenant 3 modÃ¨les, et l'utilisateur peut choisir lequel utiliser. C'est transparent, efficace, et extensible! ğŸš€
